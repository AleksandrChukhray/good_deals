<?phpclass EmailController extends Controller {    public function unsubscribeAction($AData = null) {        if (empty($AData)) {            Redirect('/');        }                // только залогинившиеся пользователи могут отписаться от рассылки        if (!isset($_SESSION['auth']) || empty($_SESSION['auth']['email'])) {            $_SESSION['login_redirect'] = '/email/unsubscribe/'.$AData;            Redirect('/auth/login');        }                $params = explode('||', Decrypt_Blowfish($AData, EMAIL_BLOWFISHGUID));        try {            if (Emails_IsNotifyRecipientActive($params[0], $params[1], $_SESSION['auth']['email'])) {                Emails_DeleteNotifyRecipient($params[0], $params[1], $_SESSION['auth']['email']);                return AddAlertMessage('success', 'Подписка на рассылку уведомлений была отменена!', '/');            } else {                return AddAlertMessage('info', 'Вы уже не подписаны на данную рассылку!', '/');            }        } catch (Exception $exc) {            return AddAlertMessage('danger', 'Ошибка при отмене подписки на рассылку уведомлений!', '/');        }    }}